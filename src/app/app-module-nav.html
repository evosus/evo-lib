<app-module-nav>
	<title-bar css="ui-secondary shadow-bar title-bar-fixed" title="{ opts.title }" mdicon="{ opts.mdicon }"></title-bar>
	<div class="title-bar-spacer"></div>
	<div class="f-row" style="min-height:calc(100vh - 7em);">
		<div class="side-bar { expanded:isExpanded, contracted:!isExpanded }">
			<div class="icon-bar fg-grey-lt pad-dot-5">
				<virtual each="{ iconBarItems }">
					<nav-bar-icon
						css="{ 
							fg-primary:name == parent.opts.title,
							noshadow:name == parent.opts.title
						}"
						mdicon="{ mdicon }"
						onclick="{ iconBarClick }">
					</nav-bar-icon>
				</virtual>
			</div>
		</div>
		<div id="moduleNavMount" class="container-flex-1280 ui-white shadow"></div>
	</div>
	<style>
		.active-icon {
			width:2.5em;
			height:2.5em;
			border-radius:50%;
		}
		.title-bar-fixed { position:fixed;width:100%; }
		.title-bar-spacer { height:3.5em; }
		.side-bar { flex:0; }
		.expanded { flex:0 0 3.5em;height:100vh;overflow:auto; }
		.contracted { height:0;width:0;overflow:hidden; }
		.expanded .icon-bar {
			position:fixed;
			height:calc(100vh - 7em);
			overflow:auto;
		}
		.side-bar.contracted .icon-bar { width:0;height:0; }
		.container-flex-1280 {
			flex:1;
			margin-left:0;
			margin-right:0;
			min-height:100%;
		}
		@media only screen and (min-width:992px) {
			.container-flex-1280 {
				flex:1;
				max-width:1280px;
				margin-left:auto;
				margin-right:auto;
			}
		}
	</style>
	<script>
		var self = this;
		isExpanded = false;
		RiotControl.on('UI_STATE_CHANGED',function(state) {
			console.info("STATE_CHANGED");
			console.dir(state);
			isExpanded = state.iconBar;
			//isExpanded ? isExpanded = false : isExpanded = true;
			self.update();
		});
		/*
		IO.on('ICON_BAR_TOGGLE',function() {
			isExpanded ? isExpanded = false : isExpanded = true;
			self.update();
		});
		*/
		iconBarItems = navMenuItems;
		iconBarClick = function(e) {
			route(e.item.route);
			console.log(e.item.route);
		}
	</script>
</app-module-nav>
