<!--
UI-MODAL WIP
!-->
<ui-modal>
	<div if="{ opts.isOpen }" onclick="{ opts.closeOutsideModal }" class="ui-modal f-col ai-center jc-center { fill:isMounted }">
		<div if="{ isModal }" class="ui-white rounded modal-shadow pad-1">
			<div class="modal-contents">
				<div class="modal-close f-row ai-center jc-end" onclick="{ opt.closeModal }">
					<i class="mdi mdi-close"></i>
				</div>
				<div id="modalMount">
					<div class="pad-1 fg-grey-lt">
						Loading...
					</div>
				</div>	
			</div>	
		</div>
	</div>
	<style>
		.modal-close {
			cursor:pointer;
		}
		.modal-close i {
			color:grey;
			transition:.2s ease-in-out all;
		}
		.modal-close:hover i {
			color:red;
		}
		.ui-modal {
			position:absolute;
			z-index:10000;	
			width:100vw;
			height:100vh;
			background:transparent;
			transition:.2s ease-in-out all;
		}
		.ui-modal.fill {
			background:rgba(0,0,0,0.75);
		}
		.modal-shadow {
			box-shadow:0px 2px 10px 4px rgba(0,0,0,0.5);
		}
	</style>
	<script>
		this.mixin(IO);
		var self = this;
		this.on('mount',function() {
			opts = this.opts;
			opts.isMounted = false;
			opts.isModal = false;
			opts.closeOutsideModal = function(e) {
				if(e.target.classList.contains('ui-modal')) {
					opts.closeModal();
				}
			}
		});
		this.on('update',function() {	
			if(opts.isOpen) {
				setTimeout(function() {
					opts.isMounted = true;
					setTimeout(function() {
						opts.isModal = true;
						setTimeout(function() {
							if(opts.template) {
								riot.compile(function() {
									riot.mount('#modalMount',opts.template);
								});
							}
						},25);
					},50);
				},100);
			}
		});
	</script>
</ui-modal>
