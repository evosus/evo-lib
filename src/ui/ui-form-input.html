<ui-form-input value="{ field.value }"
	class="ui-input {
		locked:opts.css == 'locked',
		touched:field.value.length && !isFocused,
		focus:isFocused,
		valid:isValid,
		invalid:isInvalid,
		invalid-focus:isFocused && isInvalid
	}">
	<div class="ui-input-label">
		<span>{ opts.label }</span>
		<i if="{ isTouched }" class="{ mdi:1, mdi-check:isValid, mdi-block-helper:isInvalid }"></i>
	</div>
	<div class="ui-input-stack f-row">
		<div class="ui-input-row f-row ai-center">
			<input name="field"
				class="f-one"
				type="{ opts.type || 'text' }"
				placeholder="{ opts.placeholder }"
				onfocus="{ focus }"
				onblur="{ blur }"
				onchange="{ change }"
				onkeyup="{ keyup }"
			/>
			<i class="mdi { mdi-check:isValid,mdi-alert-circle-outline:isInvalid,mdi-pencil:isFocused && !isInvalid && !isValid }"></i>
		</div>
		<div class="ui-input-fill"></div>
	</div>
	<div class="ui-input-message fg-failure">
		<span if="{ msg }" >{ msg }</span>
	</div>
	<script>
		var self = this;
		isBlurred = null;isFocused = null;isValid = null;isInvalid = null;isLocked = null;
		// --------------------------------------
		// ON MOUNT
		// --------------------------------------
		this.on('mount',function() {
			if(opts.value) { 
				opts.io.trigger(opts.name + ':change',opts.value);
			}
		});
		// --------------------------------------
		// MAP EVENTS TO OBSERVABLE (io)
		// --------------------------------------
		blur(e) { opts.io.trigger(opts.name + ':blur',e); }
		change(e) { opts.io.trigger(opts.name + ':change',e); }
		click(e) { opts.io.trigger(opts.name + ':click',e); }
		focus(e) { opts.io.trigger(opts.name + ':focus',e); }
		hover(e) { opts.io.trigger(opts.name + ':hover',e); }
		keyup(e) { opts.io.trigger(opts.name + ':keyup',e); }
		// --------------------------------------
		// ON BLUR
		// --------------------------------------
		opts.io.on(opts.name + ':blur',function() {
			self.isFocused = null;
			self.update();
		});
		// --------------------------------------
		// ON FOCUS
		// --------------------------------------
		opts.io.on(opts.name + ':focus',function(e) {
			self.field.focus();
			self.isFocused = true;
			self.update();
		});
		// --------------------------------------
		// ON CHANGE
		// --------------------------------------
		opts.io.on(opts.name + ':change',function(e) {
			if(e.target.value) {
				self.field.value = e.target.value;
				self.update();
			}
		});
		// --------------------------------------
		// ON INVALID
		// --------------------------------------
		opts.io.on(opts.name + ':invalid',function(msg) {
			if(msg || self.msg) { self.msg = msg; } else { self.msg == null }
			self.isValid = false;
			self.isInvalid = true;
			self.update();
		});
		// --------------------------------------
		// ON VALID
		// --------------------------------------
		opts.io.on(opts.name + ':valid',function(msg) {
			if(msg || self.msg) { self.msg = msg; } else { self.msg == null }
			self.isValid = true;
			self.isInvalid = false;
			self.update();
		});
		// --------------------------------------
		// ON RESET
		// --------------------------------------
		opts.io.on(opts.name + ':reset',function(msg) {
			if(msg || self.msg) { self.msg = msg; } else { self.msg == null }
			self.field.value = '';
			self.isBlurred = null;
			self.isFocused = null;
			self.isValid = null;
			self.isInvalid = null;
			self.isLocked = null;
			self.update();
		});
	</script>
</ui-form-input>
